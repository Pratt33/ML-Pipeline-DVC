schema: '2.0'
stages:
  data_ingestion:
    cmd: python src/data/make_dataset.py
    deps:
    - path: src/data/make_dataset.py
      hash: md5
      md5: 5b0bbb0dd44c389852ec0234b94bd406
      size: 3872
    outs:
    - path: data/raw/Reviews.csv
      hash: md5
      md5: a0cd10a45db57e5796b860d76abf40c5
      size: 301472984
  data_preprocess:
    cmd: python src/features/build_features.py
    deps:
    - path: data/raw/Reviews.csv
      hash: md5
      md5: a0cd10a45db57e5796b860d76abf40c5
      size: 301472984
    - path: src/features/build_features.py
      hash: md5
      md5: 924c4f10710de85d7d0f07ef2de371e3
      size: 4265
    outs:
    - path: data/processed/item_mapping.csv
      hash: md5
      md5: 8245bc509fe313d28b6d8a0036711f47
      size: 304592
    - path: data/processed/matrix_info.pkl
      hash: md5
      md5: ed166005901928c9471a4646429c5a12
      size: 79
    - path: data/processed/user_item_matrix.npz
      hash: md5
      md5: 9f3dd2e3c21d32ab79c760d8f21de4bb
      size: 368226
    - path: data/processed/user_mapping.csv
      hash: md5
      md5: b4ff13d61ac51d39954b81237ff8c26e
      size: 494420
  train_model:
    cmd: python src/models/train_model.py
    deps:
    - path: data/processed/user_item_matrix.npz
      hash: md5
      md5: 9f3dd2e3c21d32ab79c760d8f21de4bb
      size: 368226
    - path: src/models/train_model.py
      hash: md5
      md5: fad43eaf5a0deaefa2a4015f9b575af6
      size: 5507
    params:
      params.yaml:
        model.max_iter: 1000
        model.n_components: 50
        model.random_state: 42
    outs:
    - path: models/item_factors.csv
      hash: md5
      md5: 6b46106f9d5a5a69452d6ab5e7c4d6c6
      size: 20014136
    - path: models/matrix_factorization_model.pkl
      hash: md5
      md5: 0c6e63b5a86fb321b96c5242bfbf91bb
      size: 7016995
    - path: models/user_factors.csv
      hash: md5
      md5: b81d7935a42fa40f91aa06a926906895
      size: 24702705
  evaluate_model:
    cmd: python src/models/predict_model.py
    deps:
    - path: data/processed/user_item_matrix.npz
      hash: md5
      md5: 9f3dd2e3c21d32ab79c760d8f21de4bb
      size: 368226
    - path: models/item_factors.csv
      hash: md5
      md5: 6b46106f9d5a5a69452d6ab5e7c4d6c6
      size: 20014136
    - path: models/matrix_factorization_model.pkl
      hash: md5
      md5: 0c6e63b5a86fb321b96c5242bfbf91bb
      size: 7016995
    - path: models/user_factors.csv
      hash: md5
      md5: b81d7935a42fa40f91aa06a926906895
      size: 24702705
    - path: src/models/predict_model.py
      hash: md5
      md5: ec20b4ffd0f760184dde4de9cfde5641
      size: 7024
    params:
      params.yaml:
        evaluate.sample_users: 100
        evaluate.top_k: 10
    outs:
    - path: metrics/recall.json
      hash: md5
      md5: 9463080517ee73e8655cc77dfa72f76b
      size: 152
